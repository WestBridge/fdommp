{% extends 'base_form.html' %}



{% block body %}

    <section class="content">
            <div class="box box-info">
                <div class="row">
                    <!-- /.box-header -->
                    <!-- form start -->
                    <div class="col-md-6">
                    <form class="form-horizontal" id="host_add">
                      <div class="box-body">
                        <div class="form-group">
                          <label for="inputEmail3" class="col-sm-2 control-label">{{ host_modelform.h_name.label }}</label>

                          <div class="col-sm-5">
                            {{ host_modelform.h_name }}<span class="error" id="error_h_name"></span>
                          </div>
                        </div>
                        <div class="form-group">
                          <label for="inputPassword3" class="col-sm-2 control-label">{{ host_modelform.h_ip.label }}</label>

                          <div class="col-sm-5">
                             {{ host_modelform.h_ip }}<span class="error" id="error_h_ip"></span>
                          </div>
                        </div>

                      </div>
                      <!-- /.box-body -->
                      <div class="box-footer">
        {#                <button type="submit" class="btn btn-default">Cancel</button>#}
                        <button id="post_hostadd" type="button" class="btn btn-info pull-right">新增</button>
                      </div>
                      <!-- /.box-footer -->
                    </form>
                </div>
                    </div>
            </div>
    </section>
{% endblock %}

{% block js %}
    <script>
        $('#post_hostadd').click(function () {
            $.post('{% url 'hosts:hostadd' %}',$('#host_add').serialize(),function(data){
                if (data.rcode == 200){

                    var index = parent.layer.getFrameIndex(window.name);
                    parent.layer.close(index);
                    window.parent.window.refreshes_parent_table();
                }
                else{
                    var error_dic = JSON.parse(data.msg)

                    $('.error').text('')
                    for (var i in error_dic){

                        var tmp='#error_'+ i +''

                        $(tmp).text(error_dic[i][0].message);
                    }
                }
            })
        })

    </script>

{% endblock %}
